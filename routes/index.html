<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Sports-Pal</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="/styles/uikit.min.css">
    <link rel="stylesheet" href="/styles/uikit-rtl.min.css">

    <link href="https://fonts.googleapis.com/css?family=Monoton" rel="stylesheet">

    <link rel="stylesheet" href="/styles/style.css">


    <title>Sports-Pal</title>
</head>

<body>
    <div class="container">
        <h1> Sports Pal</h1>
        <p> Pick up Game or Pick up Stats. </p>
        <div class="row">
            <div class="col-md-4">
                <div class="list-group" id="list-tab" role="tablist">
                    <a class="list-group-item list-group-item-action" id="my-games" data-toggle="list" href="#list-profile" role="tab"
                        aria-controls="profile">My Games</a>
                    <a class="list-group-item list-group-item-action" id="existing-games" data-toggle="list" href="#list-messages" role="tab"
                        aria-controls="messages">Find Games</a>
                    <a class="list-group-item list-group-item-action" id="create-game" data-toggle="list" href="#list-settings" role="tab"
                        aria-controls="settings">Create Game</a>
                </div>
            </div>


            <div class="col-md-8">
                <table id="game-table" class="table animated fadeIn">
                    <thead class="thead-light">
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Game</th>
                            <th scope="col">Location</th>
                            <th scope="col">Time</th>
                            <th scope='col'>Join</th>
                        </tr>
                    </thead>
                    <tbody id='game-table-body'>
                        <tr>
                            <th scope="row">1</th>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <th scope="row">2</th>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <th scope="row">3</th>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>


            </div>
      <div id="image-reel" class="col-sm-8 animated fadeIn">
        <div id="carouselExampleSlidesOnly" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner">
              <div class="carousel-item active">
                <img class="d-block w-100" src="/images/clrm.jpg" alt="First slide">
              </div>
              <div class="carousel-item">
                <img class="d-block w-100" src="/images/worldcup 2.jpg" alt="Second slide">
              </div>
              <div class="carousel-item">
                <img class="d-block w-100" src="/images/zlatan 2.jpg" alt="Third slide">
              </div>
            </div>
          </div>
        </div>

        <div id="card-stats" class="card animated fadeIn" style="width: 18rem;">
            <img class="card-img-top" src="" alt="Card image cap">
            <div class="card-body">
              <p class="card-text-dark">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div>
          </div>
        </div>

        <div class="container">
            <div id="create-game-form" class="row col-sm-8 offset-sm-2 animated fadeIn" style="display:none;">
                <h2>Create Game</h2>
                <form>
                    <div class="form-group">
                        <label for="exampleFormControlInput1">Name</label>
                        <input type="email" class="form-control" id="exampleFormControlInput1" placeholder="">
                    </div>
                    <div class="form-group">
                        <label for="exampleFormControlSelect1">Choose Date</label>
                        <input type="date" class="form-control" id="exampleFormControlInput1" placeholder="" data-pickdate=""> 
                    </div>
                    <div class="form-group">
                        <label for="exampleFormControlSelect2">Choose venue</label>
                        <select multiple class="form-control" id="exampleFormControlSelect2">
                          <option>1</option>
                          <option>2</option>
                          <option>3</option>
                          <option>4</option>
                          <option>5</option>
                        </select>
                    </div>
                </form>
            </div>
      </div>

      <div id="login-form">
        <div class="uk-modal-dialog">
            <button class="uk-modal-close-default" type="button" uk-close></button>
        </div>
    </div>
















    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
          src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm"
        crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.3/firebase-database.js"></script>

    <script src="/javascript/uikit-icons.min.js"></script>
    <script src="/javascript/uikit.min.js"></script>
    <script src="/javascript/firebase.js"></script>
    <script src="/javascript/chatroom.js"></script>

    <script>

        var userId;

        /*
            Button listeners
        */
        $(document).ready( function () {
            // Initialize firebase and our chatroom
            var firebase = new Firebase();
            var chatroom = new Chatroom(firebase, "default username");

            // Add a listener
            firebase.setChatroom(chatroom);

            $("#my-games").click( function () {
                userGames(userId, function (games) {
                    updateTable(games);
                });
                $("#create-game-form").css("display", "none");
                $("#card-stats").css("display", "block");
                $("#image-reel").css("display", "block");
            });
            $("#existing-games").click( function () {
                games(function (games) {
                    updateTable(games);
                });
                $("#create-game-form").css("display", "none");
                $("#card-stats").css("display", "block");
                $("#image-reel").css("display", "block");
            });
            $("#create-game").click( function () {
                $("#create-game-form").css("display", "block");
                $("#card-stats").css("display", "none");
                $("#image-reel").css("display", "none");
            });
        });


        /*
            API Calls
        */

        // Grab all games
        function games(callback) {
            $.ajax({
                type: 'GET',
                url: '/api/games'
            }).then( function (response){
                callback(response);
            });
        }

        // Grab all games given a specific user id
        function userGames(userid, callback) {
            console.log('getting games for userid', userid);
            $.ajax({
                type: "GET",
                url: "/api/games/" + userid
            }).then(function (response) {
                callback(response);
            });
        }



        /*
            Table helper functions
        */
        function clearTable () {
            $("#game-table-body").html('');
        }

        function addRow(game) {
            var row = $("<tr>");
            var head = $("<th scope='row'>").text(game.id);
            var col1 = $("<td>").text(game.name);
            var col2 = $("<td>").text("Lat: " + game.latitude + " -- Long:"  + game.longitude);
            var col3 = $("<td>").text(game.event_date);
            var join = $("<button>").addClass("btn btn-default").text("X").attr("game-id", id);
            $("#game-table-body").append(row.append(head, col1, col2, col3, join))
        }

        function updateTable (games) {
            clearTable();
            games.forEach( function (game){
                addRow(game);
            });
        }
    </script>

</body>

</html>